<!-- 会員情報セクション -->
<div class="card mb-4 shadow-sm">
  <div class="custom-card-body">
    <!-- 時間帯によってメッセージを変更 -->
    <div class="text-center mb-3 pt-4">
      <% if Time.current.hour < 12 %>
        <h5>おはようございます！</h5>
      <% elsif Time.current.hour < 18 %>
        <h5>こんにちは！</h5>
      <% else %>
        <h5>こんばんは！</h5>
      <% end %>
    </div>

    <!-- 会員名 -->
    <div class="text-center mb-3">
      <%= link_to "#{current_customer.name} さん", customer_path(current_customer), class: "text-dark" %>
    </div>

    <!-- 会員画像 -->
    <div class="text-center mb-3">
      <%= link_to customer_path(current_customer) do %>
        <% if current_customer.image.attached? %>
          <%= image_tag current_customer.image, class: "img-fluid rounded-circle", style: "height: 150px; width: 150px; object-fit: cover;" %>
        <% else %>
          <%= image_tag 'no_image.jpg', class: "img-fluid rounded-circle", style: "height: 150px; width: 150px; object-fit: cover;" %>
        <% end %>
      <% end %>
    </div>

    <!-- 新規投稿モーダルボタン -->
    <div class="text-center mb-3">
      <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#NewPostModal">新規投稿</button>
    </div>

    <!-- フォロー/フォロワー情報 -->
    <table class='table'>
      <tbody>
        <tr>
          <th>
            <div class="ml-3" id="relationship-info">
              <%= render "public/relationships/customer_info", customer: current_customer %>
            </div>
          </th>
          <th>
            <%= link_to '#followersModal', data: { toggle: 'modal' } do %>
              <span style="color: black;">フォロワー</span> <span><%= current_customer.followers.count %></span>
            <% end %>
          </th>
        </tr>

        <!-- 新着通知 -->
        <tr>
          <td colspan="2">
           <div class="my-3">
            <h4 class="text-center mb-4">新着通知 (<%= current_customer.notifications.where(read: false).count %>)</h4>
            <% current_customer.notifications.where(read: false).order(created_at: :desc).limit(15).each do |notification| %>
              <div class="notification p-2 mb-2 border rounded">
                <% case notification.notifiable_type %>
                <% when "Favorite" %>
                  <%= link_to notification.notifiable_path, class: "d-flex align-items-center text-dark text-decoration-none" do %>
                    <i class="fas fa-heart mr-2 text-danger"></i>
                    <span><%= notification.notifiable.customer.name %> さんがあなたの投稿にいいねしました</span>
                  <% end %>
                <% when "Post" %>
                  <%= link_to post_path(notification.notifiable), class: "d-flex align-items-center text-dark text-decoration-none" do %>
                    <i class="fas fa-upload mr-2 text-primary"></i>
                    <span><%= notification.notifiable.customer.name %> さんが新しい投稿をしました</span>
                  <% end %>
                <% when "PostComment" %>
                  <%= link_to post_path(notification.notifiable.post), class: "d-flex align-items-center text-dark text-decoration-none" do %>
                    <i class="fas fa-comments mr-2 text-warning"></i>
                    <span><%= notification.notifiable.customer.name %> さんから投稿にコメントがありました</span>
                  <% end %>
                <% end %>
              </div>
            <% end %>
          </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!--リレーションシップスのモーダル-->
<%= render 'public/relationships/relationships_modal', customer: @customer %>


 