<div class="container mt-5">
  <div class="d-flex justify-content-end">
    <div class="mb-3">
      <%= search_form_for @q, url: searches_path, class: 'form-inline' do |f| %>
        <%= f.label :rigs_name_or_post_comments_comment_or_genre_name_or_tackle_name_or_tackle_rod_or_tackle_reel_or_tackle_line_or_tackle_bait_cont, "検索ワード", class: 'sr-only' %>
        <%= f.search_field :rigs_name_or_post_comments_comment_or_genre_name_or_tackle_name_or_tackle_rod_or_tackle_reel_or_tackle_line_or_tackle_bait_cont, class: 'form-control', placeholder: "検索ワードを入力" %>
        <%= f.submit '検索', class: 'btn btn-primary ml-2' %>
      <% end %>
    </div>
  </div>

  <div class="row">
    <!-- 会員情報セクション -->
    <div class="col-md-4 d-flex flex-column">
      <%= render 'public/customers/customer_section', customer: current_customer %>
    </div>
    
    <!-- 全通知カード -->
    <div class="col-md-8">
      <!-- いいね通知カード -->
      <div class="card mb-4">
        <div class="card-header" style="background-color: #AFDFE4;">
          <h3 class="mb-0 text-center">いいね通知</h3>
        </div>
        <div class="card-body">
          <% if @notifications.where(notifiable_type: 'Favorite').where.not(customer_id: current_customer.id).exists? %>
            <% @notifications.where(notifiable_type: 'Favorite').where.not(customer_id: current_customer.id).each do |notification| %>
              <div class="notification p-2 mb-2 border rounded">
                <%= link_to post_path(notification.notifiable.post_id), class: "d-flex align-items-center text-dark text-decoration-none" do %>
                  <i class="fas fa-heart mr-2 text-danger"></i>
                  <span><%= notification.notifiable.customer.name %> さんがあなたの投稿にいいねしました</span>
                <% end %>
              </div>
            <% end %>
          <% else %>
            <p class="text-center">いいね通知はありません</p>
          <% end %>
        </div>
      </div>

      <!-- コメント通知カード -->
      <div class="card mb-4">
        <div class="card-header" style="background-color: #AFDFE4;">
          <h3 class="mb-0 text-center">コメント通知</h3>
        </div>
        <div class="card-body">
          <% if @notifications.where(notifiable_type: 'PostComment').where.not(customer_id: current_customer.id).exists? %>
            <% @notifications.where(notifiable_type: 'PostComment').where.not(customer_id: current_customer.id).each do |notification| %>
              <div class="notification p-2 mb-2 border rounded">
                <%= link_to post_path(notification.notifiable.post_id), class: "d-flex align-items-center text-dark text-decoration-none" do %>
                  <i class="fas fa-comments mr-2 text-warning"></i>
                  <span><%= notification.notifiable.customer.name %> さんからコメントがありました</span>
                <% end %>
              </div>
            <% end %>
          <% else %>
            <p class="text-center">コメント通知はありません</p>
          <% end %>
        </div>
      </div>

      <!-- フォロー中の会員の投稿通知カード -->
      <div class="card mb-4">
        <div class="card-header" style="background-color: #AFDFE4;">
          <h3 class="mb-0 text-center">フォロー中の投稿通知</h3>
        </div>
        <div class="card-body">
          <% if @notifications.where(notifiable_type: 'Post').where.not(customer_id: current_customer.id).exists? %>
            <% @notifications.where(notifiable_type: 'Post').where.not(customer_id: current_customer.id).each do |notification| %>
              <div class="notification p-2 mb-2 border rounded">
                <%= link_to post_path(notification.notifiable), class: "d-flex align-items-center text-dark text-decoration-none" do %>
                  <i class="fas fa-upload mr-2 text-primary"></i>
                  <span><%= notification.notifiable.customer.name %> さんが新しい投稿をしました</span>
                <% end %>
              </div>
            <% end %>
          <% else %>
            <p class="text-center">フォロー中の投稿通知はありません</p>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
